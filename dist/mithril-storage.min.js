/*! 2015-05-08 */

!function(m){"use strict";function CookieStorage(){this.$storage=document.cookie=""}function LocalStorage(){this.$storage=window.localStorage}function SessionStorage(){this.$storage=window.sessionStorage}function $defaultStorage(){LocalStorage.isAvailable()?(storageName=mx.LOCAL_STORAGE,storage=new LocalStorage):(storageName=mx.COOKIE_STORAGE,storage=new CookieStorage)}var NB_EXPIRATION_DAYS=10;CookieStorage.prototype.set=function(key,value){var expiration=new Date,stringifiedValue=JSON.stringify(value);expiration.setTime(expiration.getTime()+24*NB_EXPIRATION_DAYS*60*60*1e3);var expires="expires="+d.toUTCString();this.$storage+=key+"="+stringifiedValue+"; "+expires},CookieStorage.prototype.get=function(key){for(var name=key+"=",splitCookies=this.$storage.split(";"),i=0;i<splitCookies.length;i++){for(var cookie=splitCookie[i];" "==cookie.charAt(0);)cookie=cookie.substring(1);if(0==cookie.indexOf(name))return JSON.parse(cookie.substring(name.length,cookie.length))}return""},CookieStorage.prototype.remove=function(key){for(var name=key+"=",splitCookies=this.$storage.split(";"),i=0;i<splitCookies.length;i++){for(var cookie=splitCookie[i];" "==cookie.charAt(0);)cookie=cookie.substring(1);if(0==cookie.indexOf(name)){var cookieIndex=this.$storage.indexOf(cookie);this.$storage=this.$storage.slice(cookieIndex,cookieIndex+cookie.length)}}return""},LocalStorage.prototype.set=function(key,value){this.$storage.setItem(key,JSON.stringify(value))},LocalStorage.prototype.get=function(key){return JSON.parse(this.$storage.getItem(key))},LocalStorage.prototype.remove=function(key){this.$storage.removeItem(key)},LocalStorage.isAvailable=function(){return!!window.localStorage},SessionStorage.prototype.set=function(key,value){this.$storage.setItem(key,JSON.stringify(value))},SessionStorage.prototype.get=function(key){JSON.parse(this.$storage.getItem(key))},SessionStorage.prototype.remove=function(key){this.$storage.removeItem(key)},SessionStorage.isAvailable=function(){return!!window.sessionStorage},window.mx=window.mx||{};var storage,storageName,validators={string:function(string){if("string"!=typeof string)throw new TypeError("a string is expected, but "+string+" ["+typeof string+"] given");return string},plainObject:function(object){if("object"!=typeof object)throw new TypeError("an object is expected, but "+object+"  ["+typeof object+"] given");return object}};mx.store=function(key,value){return validators.string(key),value?void storage.set(key,value):storage.get(key)},mx.storage=function(name){if(!name)return storageName;switch(name){case mx.COOKIE_STORAGE:storage=new CookieStorage;break;case mx.LOCAL_STORAGE:storage=new LocalStorage;break;case mx.SESSION_STORAGE:storage=new SessionStorage;break;case mx.DEFAULT_STORAGE:$defaultStorage();break;default:throw new Error(name+" is not a valid storage name.")}storageName=name},mx.COOKIE_STORAGE="cookie",mx.LOCAL_STORAGE="local",mx.SESSION_STORAGE="session",mx.DEFAULT_STORAGE="default",$defaultStorage()}(m);
//# sourceMappingURL=mithril-storage.js.map